
             ---===[ Qubes Security Bulletin 107 ]===---

                              2025-05-12

                 Multiple CPU brach prediction issues

User action
------------

Continue to update normally [1] in order to receive the security updates
described in the "Patching" section below. No other user action is
required in response to this QSB.

Summary
--------

Several issues has been published that affect CPU's branch prediction
behavior. Those have in common that they allow an attacker to manipulate
the branch prediction of the CPU to mount a speculative execution attack
(like the original Spectre v2 attack) despite existing mitigation being
enabled.

Researchers from VUSec (Systems and Network Security Group at VU
Amsterdam) published on 2025-05-12 [3]:

 - Indirect Target Selection (ITS, CVE-2024-28956, XSA-469 [6], part of
   INTEL-SA-01153 [8])

 - Lion Cove BPU issue (CVE-2025-24495, part of INTEL-SA-01322 [9])

 - IP-based attacks
   Believed to be sufficiently mitigated by the mitigations against ITS.
   [4]

 - History-based attacks
   Xen believed to be unaffected. [6]

Researchers from COMSEC (computer security group at ETH ZÃ¼rich)
published on 2025-05-13 [5]:

 - Branch Privilege Injection: Exploiting Branch Predictor Race
   Conditions (BPRC, CVE-2024-45332, XSN-3 [7], part of INTEL-SA-01247
   [10])

In addition to the coordinated disclosure of the above issues Intel
published internally found issues:

 - CVE-2025-20623 (part of INTEL-SA-01247 [10])

 - CVE-2024-43420 (part of INTEL-SA-01247 [10])

For more details see the linked publications.

Impact
-------

On affected systems, an attacker who manages to compromise a qube may be
able to use it to infer the contents of arbitrary system memory,
including memory assigned to other qubes.

Affected systems
-----------------

Only systems with Intel CPUs are believed to be affected. According to
Intel's description:

The ITS issue affects Intel CPUs between Whiskey Lake (8th generation
Intel Core) and Tiger Lake (11th generation Intel Core). [8]

The Lion Cove BPU issue affects Intel Lunar Lake and Arrow Lake (Core
Ultra Series 2) models. [9]

The BPRC issue affect most Intel CPUs since 8th generation Intel Core
(but see caveat below). [10]

CVE-2025-20623 affects some 10th generation Intel Core CPUs. [10]

CVE-2024-43420 affects some Intel Atom CPUs. [10]

For a detailed and full list of affected CPUs see the linked advisories.

Note that the above is based on Intel's security advisories. Intel seems
to only asses whether a CPU model is affected if it still receives
microcode updates. For the BPRC issue the researchers write that they
could observe the problem also on 7th generation Intel Core models [5].

To determine if your CPU still receives microcode updates check [11]
and/or it's product page for the "end of servicing updates" (ESU) date.
Note that only models that have or soon will be reaching their ESU date
are listed. Newer, still fully supported, models have no ESU date
listed.

Patching
---------

The following packages contain security updates that address the
vulnerabilities described in this bulletin (for CPUs still supported by
Intel):

  For Qubes 4.2, in dom0:
  - Xen packages, version 4.17.5-7
  - microcode_ctl version 2.1.20250512

These packages will migrate from the security-testing repository to the
current (stable) repository over the next two weeks after being tested
by the community. [2] Once available, the packages are to be installed
via the Qubes Update tool or its command-line equivalents. [1]

Dom0 must be restarted afterward in order for the updates to take
effect.

If you use Anti Evil Maid, you will need to reseal your secret
passphrase to new PCR values, as PCR18+19 will change due to the new
Xen binaries.

Credits
--------

See the original Xen Security Advisory.

References
-----------

[1] https://www.qubes-os.org/doc/how-to-update/
[2] https://www.qubes-os.org/doc/testing/
[3] https://vusec.net/projects/training-solo
[4] https://download.vusec.net/papers/trainingsolo_sp25.pdf section 11
[5] https://comsec.ethz.ch/research/microarch/branch-privilege-injection/
[6] https://xenbits.xen.org/xsa/advisory-469.html
[7] https://lists.xenproject.org/archives/html/xen-devel/2025-05/msg00632.html
[8] https://www.intel.com/content/www/us/en/security-center/advisory/intel-sa-01153.html
[9] https://www.intel.com/content/www/us/en/security-center/advisory/intel-sa-01322.html
[10] https://www.intel.com/content/www/us/en/security-center/advisory/intel-sa-01247.html
[11] https://www.intel.com/content/www/us/en/support/articles/000022396/processors.html

--
The Qubes Security Team
https://www.qubes-os.org/security/
